String.prototype.format=function(){for(var e=this,n=0;n<arguments.length;n++){var t=new RegExp("\\{"+n+"\\}","gi");e=e.replace(t,arguments[n])}return e};const firebaseConfig={apiKey:"AIzaSyD2JpzCkFjO-9QgGVKQCkWEWe34dBy1qbY",authDomain:"pengaduanapp-87882.firebaseapp.com",projectId:"pengaduanapp-87882",storageBucket:"pengaduanapp-87882.appspot.com",messagingSenderId:"206245474019",appId:"1:206245474019:web:0eab579a0fe91977e25fd6",measurementId:"G-QNNDLDDHXN"};if($("#notif .badge").length>0&&"0"!=$("meta[name=role]").attr("content")){firebase.initializeApp(firebaseConfig);const e=firebase.messaging();requestPermission();var x=document.getElementById("notif-tone"),notif='\n  <a href="{0}" class="dropdown-item">\n    <div class="media">\n      <div class="media-body">\n        <h3 class="dropdown-item-title font-weight-bold">\n          {1}\n        </h3>\n        <p class="text-sm">{2}</p>\n        <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> {3}</p>\n      </div>\n    </div>\n  </a>\n  ',cw='<div class="card card-danger card-outline">\n    <div class="card-body p-0">\n      <div class="mailbox-read-info">\n        <h6>\n          <span class="font-weight-bold text-uppercase">\n           {0}\n          </span>\n          <span class="mailbox-read-time float-right">{1}</span>\n        </h6>\n      </div>\n      <div class="mailbox-read-message">\n        {2}\n      </div>\n    </div>\n  </div>',ncount=Number($("#notif-count").text());function requestPermission(){Notification.requestPermission().then(e=>{"granted"===e?getToken():toastr.error("Notifikasi tidak berfungsi. Pastikan anda menerima notifikasi dari website ini!")})}function getToken(){e.getToken({vapidKey:"BJP0xliVPKv1T9T1N4E4jGox6zIIcn_gcdNryL_Na7B8U_etQS2e6w5WP2hQKT2AUsqt1FYO7IULrWPCPvjVIX0"}).then(e=>{e&&sendTokentoServer(e)})}function sendTokentoServer(e){const n={_token:$("meta[name=_csrf]").attr("content"),fb_token:e,_method:"PUT"};$.ajax({url:"/token",type:"PUT",dataType:"json",data:n,success:function(e){},error:function(e){console.log(e)}})}e.onMessage(e=>{if($("#message-wrap").length>0){$.get("/readed",{notif:e.data.notif},function(e){},"json");var n=cw.format(e.data.title,e.data.time,e.data.message_full);$("#message-wrap").append(n)}else{ncount++,$("title").html("("+ncount+") "+$("title").text()),$("#notif-count").text(ncount),$("#notif-count").is(":visible")||($("#notif-count").removeClass("d-none"),$("#notif-none").remove());n=notif.format(e.data.url,e.data.title,e.data.message,e.data.time);$("#notif-wrapper").prepend(n)}x.play()})}